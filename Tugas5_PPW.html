
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>TF-IDF &amp; Word Embedding &#8212; PPW</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Tugas5_PPW';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="CRAWLING PTA MANAJEMEN" href="Tugas4_PPW.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="PPW - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="PPW - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    PROFIL
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Tugas1_PPW.html"><strong>Pengantar Web Mining</strong></a></li>







<li class="toctree-l1"><a class="reference internal" href="Tugas2_PPW.html"><strong>Crawling</strong></a></li>









<li class="toctree-l1"><a class="reference internal" href="Tugas3_PPW.html">Crawling PTA &amp; Berita</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tugas4_PPW.html">CRAWLING PTA MANAJEMEN</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">TF-IDF &amp; Word Embedding</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FTugas5_PPW.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Tugas5_PPW.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>TF-IDF & Word Embedding</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tf-idf-vectorizer">TF - IDF Vectorizer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#word-embeding">Word Embeding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#klasifikasi">Klasifikasi</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="tf-idf-word-embedding">
<h1>TF-IDF &amp; Word Embedding<a class="headerlink" href="#tf-idf-word-embedding" title="Link to this heading">#</a></h1>
<section id="tf-idf-vectorizer">
<h2>TF - IDF Vectorizer<a class="headerlink" href="#tf-idf-vectorizer" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.feature_extraction.text</span><span class="w"> </span><span class="kn">import</span> <span class="n">CountVectorizer</span><span class="p">,</span> <span class="n">TfidfTransformer</span>

<span class="c1"># Konfigurasi Pandas untuk tampilan penuh</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.width&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="c1"># Fungsi untuk membersihkan teks</span>
<span class="k">def</span><span class="w"> </span><span class="nf">clean_text</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Membersihkan teks dengan mengubahnya menjadi huruf kecil,</span>
<span class="sd">    menghapus tanda baca, angka, dan spasi berlebih.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^\w\s]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>   <span class="c1"># hapus tanda baca</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>       <span class="c1"># hapus angka</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># hapus spasi berlebih</span>
    <span class="k">return</span> <span class="n">text</span>

<span class="c1"># Menggunakan try-except untuk membaca data dari file CSV</span>
<span class="k">try</span><span class="p">:</span>
    <span class="c1"># Membaca seluruh data dari file CSV berita_tempo.csv</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;berita_tempo.csv&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Berhasil memuat seluruh data dari &#39;berita_tempo.csv&#39;.&quot;</span><span class="p">)</span>
    
    <span class="c1"># Gunakan kolom &#39;isi&#39; sebagai korpus</span>
    <span class="n">corpus</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;isi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: File &#39;berita_tempo.csv&#39; tidak ditemukan.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Menggunakan data dummy untuk demonstrasi.&quot;</span><span class="p">)</span>
    <span class="n">corpus</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;Pelatih Atletico Madrid, Diego Simeone, mengaku kesal saat dihina fans Liverpool sepanjang pertandingan.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Atletico Madrid takluk dari Liverpool dengan skor 2-3 di Anfield pada lanjutan Liga Champions.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Bicara soal seberapa hebat Lionel Messi, Zinedine Zidane punya sudut pandang berbeda.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Marc Marquez menjalani operasi pada lengannya usai kecelakaan di MotoGP Portugal 2025.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Pebalap Yamaha, Alex Rins akan menggunakan motor M1 yang dikembangkan untuk 2026.&quot;</span>
    <span class="p">]</span>

<span class="c1"># Menerapkan pembersihan teks pada korpus</span>
<span class="n">cleaned_corpus</span> <span class="o">=</span> <span class="p">[</span><span class="n">clean_text</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">corpus</span><span class="p">]</span>

<span class="c1"># Inisialisasi CountVectorizer untuk menghitung Term Frequency (TF)</span>
<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">cleaned_corpus</span><span class="p">)</span>
<span class="n">count_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">toarray</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">())</span>

<span class="c1"># Inisialisasi TfidfTransformer untuk menghitung IDF dan TF-IDF</span>
<span class="n">transformer</span> <span class="o">=</span> <span class="n">TfidfTransformer</span><span class="p">()</span>

<span class="c1"># ---</span>
<span class="c1">### 1. Hasil Count Vectorizer (Matriks Term Frequency)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;&gt; Count Vectorizer (Matriks Term Frequency):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">count_df</span><span class="o">.</span><span class="n">to_string</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>

<span class="c1"># ---</span>
<span class="c1">### 2. Hasil IDF (Inverse Document Frequency)</span>
<span class="n">transformer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">idf_values</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">idf_</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>
<span class="n">idf_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;word&#39;</span><span class="p">:</span> <span class="n">feature_names</span><span class="p">,</span> <span class="s1">&#39;idf_value&#39;</span><span class="p">:</span> <span class="n">idf_values</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;&gt; IDF (Inverse Document Frequency):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">idf_df</span><span class="o">.</span><span class="n">to_string</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>

<span class="c1"># ---</span>
<span class="c1">### 3. Hasil TF-IDF (Term Frequency - Inverse Document Frequency)</span>
<span class="n">tfidf_matrix</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">tfidf_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tfidf_matrix</span><span class="o">.</span><span class="n">toarray</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="n">feature_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;&gt; TF-IDF (Term Frequency - Inverse Document Frequency):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tfidf_df</span><span class="o">.</span><span class="n">to_string</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Berhasil memuat seluruh data dari &#39;berita_tempo.csv&#39;.
---
&gt;&gt;&gt; Count Vectorizer (Matriks Term Frequency):
     nan
0      1
1      1
2      1
3      1
4      1
5      1
6      1
7      1
8      1
9      1
10     1
11     1
12     1
13     1
14     1
15     1
16     1
17     1
18     1
19     1
20     1
21     1
22     1
23     1
24     1
25     1
26     1
27     1
28     1
29     1
30     1
31     1
32     1
33     1
34     1
35     1
36     1
37     1
38     1
39     1
40     1
41     1
42     1
43     1
44     1
45     1
46     1
47     1
48     1
49     1
50     1
51     1
52     1
53     1
54     1
55     1
56     1
57     1
58     1
59     1
60     1
61     1
62     1
63     1
64     1
65     1
66     1
67     1
68     1
69     1
70     1
71     1
72     1
73     1
74     1
75     1
76     1
77     1
78     1
79     1
80     1
81     1
82     1
83     1
84     1
85     1
86     1
87     1
88     1
89     1
90     1
91     1
92     1
93     1
94     1
95     1
96     1
97     1
98     1
99     1
100    1
101    1
102    1
103    1
104    1
105    1
106    1
107    1
108    1
109    1
110    1
111    1
112    1
113    1
114    1
115    1
116    1
117    1
118    1
119    1
120    1
121    1
122    1
123    1
124    1
125    1
126    1
127    1
128    1
129    1
130    1
131    1
132    1
133    1
134    1
135    1
136    1
137    1
138    1
139    1
140    1
141    1
142    1
143    1
144    1
145    1
146    1
147    1
148    1
--------------------------------------------------
&gt;&gt;&gt; IDF (Inverse Document Frequency):
  word  idf_value
0  nan        1.0
--------------------------------------------------
&gt;&gt;&gt; TF-IDF (Term Frequency - Inverse Document Frequency):
     nan
0    1.0
1    1.0
2    1.0
3    1.0
4    1.0
5    1.0
6    1.0
7    1.0
8    1.0
9    1.0
10   1.0
11   1.0
12   1.0
13   1.0
14   1.0
15   1.0
16   1.0
17   1.0
18   1.0
19   1.0
20   1.0
21   1.0
22   1.0
23   1.0
24   1.0
25   1.0
26   1.0
27   1.0
28   1.0
29   1.0
30   1.0
31   1.0
32   1.0
33   1.0
34   1.0
35   1.0
36   1.0
37   1.0
38   1.0
39   1.0
40   1.0
41   1.0
42   1.0
43   1.0
44   1.0
45   1.0
46   1.0
47   1.0
48   1.0
49   1.0
50   1.0
51   1.0
52   1.0
53   1.0
54   1.0
55   1.0
56   1.0
57   1.0
58   1.0
59   1.0
60   1.0
61   1.0
62   1.0
63   1.0
64   1.0
65   1.0
66   1.0
67   1.0
68   1.0
69   1.0
70   1.0
71   1.0
72   1.0
73   1.0
74   1.0
75   1.0
76   1.0
77   1.0
78   1.0
79   1.0
80   1.0
81   1.0
82   1.0
83   1.0
84   1.0
85   1.0
86   1.0
87   1.0
88   1.0
89   1.0
90   1.0
91   1.0
92   1.0
93   1.0
94   1.0
95   1.0
96   1.0
97   1.0
98   1.0
99   1.0
100  1.0
101  1.0
102  1.0
103  1.0
104  1.0
105  1.0
106  1.0
107  1.0
108  1.0
109  1.0
110  1.0
111  1.0
112  1.0
113  1.0
114  1.0
115  1.0
116  1.0
117  1.0
118  1.0
119  1.0
120  1.0
121  1.0
122  1.0
123  1.0
124  1.0
125  1.0
126  1.0
127  1.0
128  1.0
129  1.0
130  1.0
131  1.0
132  1.0
133  1.0
134  1.0
135  1.0
136  1.0
137  1.0
138  1.0
139  1.0
140  1.0
141  1.0
142  1.0
143  1.0
144  1.0
145  1.0
146  1.0
147  1.0
148  1.0
--------------------------------------------------
</pre></div>
</div>
</div>
</div>
</section>
<section id="word-embeding">
<h2>Word Embeding<a class="headerlink" href="#word-embeding" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gensim.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Word2Vec</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">spacy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">pipeline</span>

<span class="c1"># --- Bagian 1: Word Embedding (Pembuatan Representasi Vektor) dengan Gensim ---</span>

<span class="c1"># Konfigurasi Pandas dan Numpy untuk tampilan penuh</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.width&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;&gt; Bagian 1: Membuat Word Embedding dengan Gensim&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---&quot;</span><span class="p">)</span>

<span class="c1"># Membaca data</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;berita_tempo.csv&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Berhasil memuat seluruh data dari &#39;berita_tempo.csv&#39;.&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: File &#39;berita_tempo.csv&#39; tidak ditemukan.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Gunakan data dummy untuk demonstrasi.&quot;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;judul&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;Manajemen strategi perusahaan menghadapi persaingan global&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Pengaruh kepemimpinan terhadap kinerja organisasi&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Analisis keuangan perusahaan berbasis rasio likuiditas&quot;</span>
    <span class="p">]}</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Gunakan kolom &#39;judul&#39; sebagai korpus (karena &#39;isi&#39; NaN semua)</span>
<span class="n">corpus</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;judul&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Pembersihan teks dasar</span>
<span class="k">def</span><span class="w"> </span><span class="nf">clean_text</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^\w\s]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">text</span>

<span class="c1"># Tokenisasi untuk Word2Vec (list of lists)</span>
<span class="n">tokenized_corpus</span> <span class="o">=</span> <span class="p">[</span><span class="n">clean_text</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">corpus</span> <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>

<span class="c1"># Bangun model Word2Vec</span>
<span class="n">embedding_dim</span> <span class="o">=</span> <span class="mi">128</span>
<span class="k">if</span> <span class="n">tokenized_corpus</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">tokenized_corpus</span><span class="p">):</span>
    <span class="n">word2vec_model</span> <span class="o">=</span> <span class="n">Word2Vec</span><span class="p">(</span>
        <span class="n">sentences</span><span class="o">=</span><span class="n">tokenized_corpus</span><span class="p">,</span>
        <span class="n">vector_size</span><span class="o">=</span><span class="n">embedding_dim</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">sg</span><span class="o">=</span><span class="mi">0</span>  <span class="c1"># CBOW, pakai sg=1 kalau mau Skip-gram</span>
    <span class="p">)</span>
    <span class="n">word2vec_model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">tokenized_corpus</span><span class="p">,</span> <span class="n">total_examples</span><span class="o">=</span><span class="n">word2vec_model</span><span class="o">.</span><span class="n">corpus_count</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="n">words</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">word2vec_model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">index_to_key</span><span class="p">)</span>
    <span class="n">vectors</span> <span class="o">=</span> <span class="p">[</span><span class="n">word2vec_model</span><span class="o">.</span><span class="n">wv</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">]</span>

    <span class="n">embedding_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">vectors</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">words</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&gt;&gt;&gt; Word Embeddings yang sudah terlatih (contoh beberapa kata):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">embedding_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">to_string</span><span class="p">())</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Korpus kosong atau tidak valid, tidak dapat membuat embeddings.&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&gt;&gt;&gt; Bagian 2: Analisis Sentimen (Fallback Kamus, tanpa PyTorch)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---&quot;</span><span class="p">)</span>

<span class="c1"># Kamus kata positif dan negatif (lebih kaya, khusus untuk berita olahraga)</span>
<span class="n">positive_words</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;bagus&quot;</span><span class="p">,</span><span class="s2">&quot;baik&quot;</span><span class="p">,</span><span class="s2">&quot;positif&quot;</span><span class="p">,</span><span class="s2">&quot;hebat&quot;</span><span class="p">,</span><span class="s2">&quot;menang&quot;</span><span class="p">,</span><span class="s2">&quot;sukses&quot;</span><span class="p">,</span><span class="s2">&quot;senang&quot;</span><span class="p">,</span><span class="s2">&quot;gembira&quot;</span><span class="p">,</span><span class="s2">&quot;puas&quot;</span><span class="p">,</span>
    <span class="s2">&quot;mantap&quot;</span><span class="p">,</span><span class="s2">&quot;unggul&quot;</span><span class="p">,</span><span class="s2">&quot;kemenangan&quot;</span><span class="p">,</span><span class="s2">&quot;dramatis&quot;</span><span class="p">,</span><span class="s2">&quot;permalukan&quot;</span><span class="p">,</span><span class="s2">&quot;raih&quot;</span><span class="p">,</span><span class="s2">&quot;lolos&quot;</span><span class="p">,</span><span class="s2">&quot;ungguli&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bangkit&quot;</span><span class="p">,</span><span class="s2">&quot;berhasil&quot;</span><span class="p">,</span><span class="s2">&quot;gemilang&quot;</span><span class="p">,</span><span class="s2">&quot;pecah&quot;</span><span class="p">,</span><span class="s2">&quot;unggulan&quot;</span>
<span class="p">}</span>

<span class="n">negative_words</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;buruk&quot;</span><span class="p">,</span><span class="s2">&quot;jelek&quot;</span><span class="p">,</span><span class="s2">&quot;negatif&quot;</span><span class="p">,</span><span class="s2">&quot;kalah&quot;</span><span class="p">,</span><span class="s2">&quot;gagal&quot;</span><span class="p">,</span><span class="s2">&quot;marah&quot;</span><span class="p">,</span><span class="s2">&quot;sedih&quot;</span><span class="p">,</span><span class="s2">&quot;kecewa&quot;</span><span class="p">,</span><span class="s2">&quot;khawatir&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rusak&quot;</span><span class="p">,</span><span class="s2">&quot;problem&quot;</span><span class="p">,</span><span class="s2">&quot;kontroversi&quot;</span><span class="p">,</span><span class="s2">&quot;dibatasi&quot;</span><span class="p">,</span><span class="s2">&quot;skandal&quot;</span><span class="p">,</span><span class="s2">&quot;batal&quot;</span><span class="p">,</span><span class="s2">&quot;terpuruk&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ancaman&quot;</span><span class="p">,</span><span class="s2">&quot;hancur&quot;</span><span class="p">,</span><span class="s2">&quot;bentrok&quot;</span><span class="p">,</span><span class="s2">&quot;krisis&quot;</span>
<span class="p">}</span>

<span class="k">def</span><span class="w"> </span><span class="nf">simple_sentiment</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">pos_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">word</span> <span class="ow">in</span> <span class="n">text</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">positive_words</span><span class="p">)</span>
    <span class="n">neg_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">word</span> <span class="ow">in</span> <span class="n">text</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">negative_words</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">pos_count</span> <span class="o">&gt;</span> <span class="n">neg_count</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;POSITIVE&quot;</span><span class="p">,</span> <span class="n">pos_count</span> <span class="o">/</span> <span class="p">(</span><span class="n">pos_count</span> <span class="o">+</span> <span class="n">neg_count</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">neg_count</span> <span class="o">&gt;</span> <span class="n">pos_count</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;NEGATIVE&quot;</span><span class="p">,</span> <span class="n">neg_count</span> <span class="o">/</span> <span class="p">(</span><span class="n">pos_count</span> <span class="o">+</span> <span class="n">neg_count</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;NEUTRAL&quot;</span><span class="p">,</span> <span class="mf">0.0</span>

<span class="c1"># Ambil contoh 10 judul pertama</span>
<span class="n">judul_contoh</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;judul&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">teks</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">judul_contoh</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">label</span><span class="p">,</span> <span class="n">score</span> <span class="o">=</span> <span class="n">simple_sentiment</span><span class="p">(</span><span class="n">teks</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Judul </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: &#39;</span><span class="si">{</span><span class="n">teks</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Label: </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2"> -&gt; Skor: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>

<span class="c1"># --- Bagian 3: Deteksi Entitas Bernama (NER dengan spaCy) ---</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&gt;&gt;&gt; Bagian 3: Deteksi Entitas Bernama (Menggunakan spaCy)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---&quot;</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;en_core_web_sm&quot;</span><span class="p">)</span>  <span class="c1"># model default bahasa Inggris</span>
    <span class="c1"># Ambil contoh teks dari dataset (judul pertama)</span>
    <span class="n">teks_ner</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;judul&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;judul&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> \
               <span class="s2">&quot;Apple Inc. founded by Steve Jobs in California, is a major technology company.&quot;</span>

    <span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">teks_ner</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Teks: </span><span class="si">{</span><span class="n">teks_ner</span><span class="p">[:</span><span class="mi">120</span><span class="p">]</span><span class="si">}</span><span class="s2">...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Entitas yang Terdeteksi:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    - </span><span class="si">{</span><span class="n">ent</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">ent</span><span class="o">.</span><span class="n">label_</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model spaCy &#39;en_core_web_sm&#39; tidak ditemukan.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Silakan install dengan perintah: python -m spacy download en_core_web_sm&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; Bagian 1: Membuat Word Embedding dengan Gensim
---
Berhasil memuat seluruh data dari &#39;berita_tempo.csv&#39;.

&gt;&gt;&gt; Word Embeddings yang sudah terlatih (contoh beberapa kata):
                0         1         2         3         4         5         6         7         8         9         10        11        12        13        14        15        16        17        18        19        20        21        22        23        24        25        26        27        28        29        30        31        32        33        34        35        36        37        38        39        40        41        42        43        44        45        46        47        48        49        50        51        52        53        54        55        56        57        58        59        60        61        62        63        64        65        66        67        68        69        70        71        72        73        74        75        76        77        78        79        80        81        82        83        84        85        86        87        88        89        90        91        92        93        94        95        96        97        98        99        100       101       102       103       104       105       106       107       108       109       110       111       112       113       114       115       116       117       118       119       120       121       122       123       124       125       126       127
di        -0.000034 -0.004503  0.004510  0.009194 -0.002643 -0.005972  0.006196  0.003979 -0.002230  0.000770  0.008108 -0.001315 -0.006881  0.000438  0.001864  0.006038 -0.002193  0.000571 -0.012555  0.000307  0.009450  0.006759 -0.000783 -0.006671 -0.002186  0.000674 -0.005726  0.006825 -0.007185 -0.005429 -0.007549 -0.001111  0.007993 -0.003636 -0.004418  0.003742  0.011086 -0.006574  0.001210 -0.001652 -0.009928  0.004943 -0.010532 -0.005316  0.003925 -0.000601 -0.008743  0.006476  0.002791  0.008124 -0.001933  0.005638 -0.003610  0.002033  0.006025 -0.003840  0.009937 -0.007726 -0.006496  0.006532 -0.004510  0.001547  0.000011 -0.005516  0.004958  0.001252  0.000216  0.006027 -0.002908 -0.002632  0.003818  0.003181 -0.008690 -0.012742  0.003390 -0.003059  0.005210 -0.003098 -0.004947 -0.003129 -0.003559  0.001841  0.007585  0.011971 -0.001214  0.007374  0.009448 -0.009583  0.001920  0.009159 -0.001778 -0.001600  0.004355 -0.002375  0.013823  0.006571 -0.010454 -0.009631  0.000052  0.004088 -0.013764  0.005296  0.002119  0.004577  0.007175 -0.002731 -0.002155  0.007681  0.000388 -0.009499  0.003869 -0.010747 -0.004692  0.006309  0.000721  0.007005  0.006522  0.007240 -0.000719  0.000910 -0.000684 -0.008565  0.004242 -0.006204  0.001981 -0.001579 -0.006919  0.003910
indonesia -0.001119  0.003185  0.008082 -0.002392  0.001740 -0.004910  0.003875  0.000745  0.005973  0.006568  0.008788  0.007295  0.004965 -0.007403 -0.004428  0.002982 -0.004294  0.006482  0.001628  0.002510  0.002631  0.002875  0.003283 -0.011219 -0.003453  0.004126 -0.003166  0.007402  0.006684  0.004062 -0.001677  0.006042 -0.006644  0.003782 -0.005031 -0.001674  0.005282  0.003681  0.006322 -0.003713  0.005294  0.005642 -0.004189 -0.007772  0.005906  0.004997 -0.002310 -0.006264 -0.005947 -0.001609  0.006032 -0.001960 -0.007476  0.003909  0.003805 -0.005399  0.003834 -0.002530 -0.001543 -0.008122  0.001123 -0.003037  0.002417 -0.001110  0.004320 -0.006387 -0.001909  0.002824  0.003765 -0.003920 -0.007446  0.002182 -0.003627  0.000032 -0.004926 -0.002385  0.005952  0.004460 -0.004215  0.003626 -0.007715  0.004395 -0.002217  0.000498  0.008990  0.003203  0.008116 -0.007128  0.005851  0.009483 -0.007700 -0.004891 -0.005140 -0.004881 -0.000365 -0.005591  0.004682 -0.005986  0.006341  0.003408 -0.008072  0.004132  0.003790 -0.005646 -0.005191 -0.000850 -0.007876  0.000028  0.001018  0.000528  0.002992 -0.001839 -0.004190  0.001502 -0.001876  0.006160  0.003337  0.004525  0.002426 -0.001502 -0.004030 -0.002661  0.000317 -0.001059 -0.006852 -0.007563 -0.008620 -0.003965
timnas    -0.000914 -0.005826 -0.004466 -0.001907  0.005749 -0.003782  0.007632 -0.000375 -0.004898  0.009261  0.007464  0.004152 -0.006816  0.002329  0.006492  0.007844  0.001070  0.001736 -0.005806  0.010820  0.009322  0.004544 -0.005372 -0.003955 -0.003021 -0.004912 -0.008976  0.001206  0.000745 -0.005617 -0.004906 -0.005515  0.006463  0.001657 -0.004992  0.007146  0.009963 -0.003714  0.006637  0.005149  0.003699  0.000950  0.004762 -0.006462 -0.004378  0.007341 -0.001721 -0.002723  0.003089 -0.002632  0.004593  0.006695  0.004617 -0.005004  0.007187  0.003457  0.006414 -0.005948  0.004942 -0.002343  0.005753 -0.003452 -0.004325  0.005891  0.004420 -0.001705  0.007692  0.008132 -0.008399 -0.000449  0.004890  0.001388 -0.002565 -0.002505  0.001149 -0.004336 -0.005795 -0.003468  0.001654  0.008601  0.006133 -0.005279 -0.005430  0.010693  0.004524  0.007088  0.007295 -0.004939  0.007822  0.004356  0.000835 -0.002981 -0.001704 -0.003095  0.006152  0.001715 -0.009295 -0.010157 -0.004979 -0.000832 -0.001809  0.008957  0.004021 -0.003187  0.001000  0.005323  0.004423  0.000501  0.004907 -0.006551  0.001350  0.004608 -0.001688 -0.007401  0.003260 -0.002063 -0.000888  0.008975 -0.000553 -0.003025 -0.004940  0.003099 -0.005570  0.002748 -0.005746  0.003076  0.001658  0.002662
nepal     -0.000722 -0.005381  0.007499  0.005685  0.001316 -0.007712 -0.005112 -0.002801  0.000825  0.000428  0.009737 -0.000316  0.002582 -0.009206  0.002003  0.001047 -0.008679  0.000584 -0.009531  0.003118  0.005445  0.006744 -0.002873 -0.002942 -0.007693  0.007777 -0.008156  0.005632 -0.007553  0.000170 -0.004804 -0.003526 -0.001914  0.005396  0.002667 -0.000836  0.003890 -0.007973  0.007390  0.008579 -0.003909  0.001605 -0.001809  0.003291 -0.003946 -0.000261  0.004239  0.001157 -0.000113 -0.006766  0.009873 -0.003578 -0.002410  0.003975 -0.001148  0.001405  0.005504 -0.006461 -0.010242  0.007295  0.003038 -0.004504  0.004522  0.000009  0.007521 -0.006773  0.003761  0.004307  0.007144 -0.006272 -0.001095 -0.008240 -0.012792 -0.010801 -0.000976 -0.007804  0.003377 -0.006660  0.000213  0.003624 -0.004721 -0.001215  0.009833  0.011727 -0.001288  0.011336 -0.001783  0.000653  0.000504  0.005340 -0.000154  0.004284 -0.000932  0.005056  0.010052 -0.006042 -0.008003 -0.008438  0.001638 -0.002683 -0.010519 -0.004664  0.005328  0.001558 -0.006755 -0.002206  0.001104 -0.001631  0.005812 -0.006328  0.004854 -0.009266  0.004354  0.004647 -0.000752  0.002740 -0.005951  0.002727  0.000896 -0.006381 -0.009507 -0.004878  0.001451  0.003489 -0.007376 -0.008268 -0.006241 -0.001901
dunia     -0.005054 -0.010418 -0.001786 -0.005768 -0.002070 -0.005018 -0.001277 -0.003150 -0.006308  0.001902  0.007995  0.005920 -0.007730 -0.005885  0.005948 -0.002856 -0.001645  0.005603  0.000799 -0.001889 -0.001393 -0.004690 -0.003704  0.003407  0.000963  0.006147  0.000709 -0.001173  0.007019 -0.006893 -0.007046 -0.001716 -0.000311 -0.001131 -0.001869  0.009084  0.002698 -0.001854  0.003028 -0.004993  0.004983  0.007327 -0.009562  0.000685  0.009927 -0.006582 -0.006862 -0.006853  0.005837  0.000158  0.009948 -0.005261  0.003060  0.003213  0.000335  0.001853 -0.001854 -0.008508 -0.000278  0.004428  0.004418  0.005384  0.001351  0.006851 -0.003841  0.002222  0.000895  0.003711  0.005192 -0.007867  0.004474 -0.009509 -0.004986 -0.010291 -0.003905  0.005482 -0.002077  0.000532  0.005616  0.009438 -0.008237 -0.003209  0.009694  0.008077  0.000713 -0.003144  0.004870 -0.008833  0.009058 -0.001305 -0.002810 -0.000238  0.000676 -0.000305  0.008873  0.001298 -0.004264 -0.003516  0.004346  0.000186 -0.004770  0.009073 -0.005031 -0.000722  0.008161  0.006943 -0.000206 -0.005366  0.002402 -0.004547  0.010054 -0.001274  0.000867  0.002558 -0.002866 -0.003072  0.000478 -0.000780  0.006386  0.008082 -0.001846 -0.000940 -0.006334  0.002003 -0.007427 -0.008988 -0.006546 -0.006522
vs         0.006387 -0.006550  0.007370 -0.004537  0.004751  0.007033 -0.005234 -0.009103 -0.002745 -0.000598  0.001066 -0.006762 -0.007988  0.000589 -0.003697 -0.004190 -0.003593 -0.006715 -0.008406 -0.003081  0.001039 -0.001921  0.002754 -0.002369 -0.005982  0.006559 -0.006733 -0.002383 -0.005871 -0.004475 -0.002462  0.005376 -0.002162  0.005599  0.004277 -0.003761  0.006071  0.004246 -0.002048  0.005998  0.004316 -0.004873 -0.006595  0.001174  0.000400 -0.004634  0.005669 -0.004864 -0.005745  0.000320  0.000032  0.001330 -0.002962  0.000311 -0.000684  0.000243  0.009251 -0.005363 -0.002774  0.003820  0.005155 -0.002960  0.008825  0.006975 -0.000795 -0.000033  0.003417 -0.002388 -0.004974 -0.007167 -0.000628 -0.001513 -0.000341 -0.004237  0.000303  0.000985  0.003935 -0.001760 -0.006488 -0.006102 -0.000868  0.004802  0.002913 -0.004018 -0.004823  0.007828 -0.000653  0.002714 -0.003573  0.008591 -0.006136  0.001635 -0.000058 -0.006332 -0.000048  0.000500 -0.005912 -0.003427 -0.006091  0.001524  0.004596 -0.000986 -0.000751  0.003321  0.007660 -0.003640 -0.006872 -0.000695  0.008530 -0.001112 -0.004956 -0.002562  0.007903 -0.005687 -0.005612  0.008415 -0.007078  0.004249  0.001778  0.005927  0.006101 -0.004065 -0.003867  0.007934  0.000548  0.003470 -0.008821  0.008076
dan       -0.000459 -0.008577  0.002718  0.001019  0.007469 -0.002287 -0.002437 -0.000515  0.007667 -0.000800  0.004022 -0.006573 -0.008030 -0.004376 -0.002503  0.008818 -0.002472 -0.001856 -0.000625  0.014263  0.009439  0.000729 -0.003481 -0.008828 -0.012140  0.007784 -0.005681  0.001416 -0.002514 -0.005161  0.001744 -0.003766 -0.007129  0.008848  0.001126  0.011549  0.009207  0.001297  0.008816 -0.001688 -0.007238  0.004278 -0.000064 -0.005806  0.011034 -0.003385  0.005708 -0.000292 -0.006169 -0.000912 -0.002314 -0.000595  0.000596  0.008934  0.006925 -0.005725  0.008019  0.000051 -0.004922 -0.007424 -0.001603 -0.005340  0.007554 -0.004477  0.009045  0.006998  0.000408  0.004346 -0.002324  0.002261  0.002794 -0.010062 -0.008045 -0.001538 -0.000129 -0.003584 -0.001516 -0.003451 -0.001698  0.006543 -0.005885 -0.003726  0.002703  0.005321  0.002703  0.000750  0.007069 -0.006588  0.004901  0.003453  0.001992 -0.006935 -0.004234 -0.005373  0.012430  0.000514 -0.010090 -0.003437 -0.004163  0.003949 -0.013587  0.003985 -0.009061  0.000883  0.005618  0.007867 -0.008132 -0.002529 -0.003214 -0.010117 -0.004262 -0.004923 -0.000976 -0.005389  0.003688  0.001736  0.005324  0.002335  0.002436 -0.004637 -0.003903 -0.000981 -0.006121  0.002344 -0.000568 -0.004816  0.005299  0.007252
piala      0.002538  0.003721  0.004926 -0.004023 -0.002409 -0.006233 -0.005317  0.005304 -0.001253 -0.003677 -0.002078  0.003917 -0.003570 -0.004783  0.003809  0.001100 -0.002977  0.001269 -0.004689  0.010411  0.004550 -0.006720  0.002361 -0.008192 -0.002169  0.004841 -0.006507 -0.000893  0.006100 -0.003928 -0.006991  0.007466 -0.001618 -0.002539  0.005851  0.005554  0.005623  0.006745 -0.006561  0.004958  0.000954  0.003718 -0.000090  0.002651  0.005218  0.004546 -0.003764 -0.004629 -0.000784  0.002537 -0.000599  0.005417  0.003314  0.006847  0.002071  0.006261  0.001413  0.005719  0.001397 -0.006739 -0.004266 -0.001365  0.005132 -0.000447  0.000288  0.006240  0.007716 -0.000807 -0.004582 -0.005608 -0.003751 -0.008797 -0.001859 -0.005549  0.002269  0.003344 -0.003757 -0.009086  0.000286 -0.003975  0.000873 -0.003908  0.006700  0.003157  0.004326  0.000359  0.000392  0.003679  0.003051 -0.003056 -0.007346  0.000103  0.005665  0.003475 -0.004543  0.007946  0.001850  0.004286  0.007712 -0.006613 -0.009700  0.005764  0.006902  0.002830  0.006078  0.000092  0.005286 -0.006603 -0.005417 -0.006988 -0.001432  0.002457 -0.003147 -0.006073  0.005436 -0.002188  0.006815 -0.003171  0.003771  0.004539  0.001173 -0.004192  0.001331 -0.005922 -0.003546 -0.003421  0.004317 -0.001944
kpk       -0.004871  0.000913 -0.000154 -0.001909  0.007887  0.003024 -0.002667 -0.001341  0.008040  0.008096  0.006580  0.003494 -0.000088 -0.003947 -0.001993  0.004079 -0.003771 -0.000460 -0.008261  0.010212 -0.003182 -0.003920 -0.005663 -0.005399 -0.010036  0.002207 -0.006922  0.000149 -0.006664  0.000678  0.001594 -0.000142 -0.003989 -0.000024  0.004592  0.006232 -0.004156 -0.003348  0.002985  0.003122 -0.009018  0.004202 -0.008718 -0.007230  0.005178 -0.003161  0.000928  0.006384 -0.003552  0.007573  0.003830  0.009149  0.004464 -0.006134 -0.003060  0.004871  0.008214  0.005406  0.003343  0.006242 -0.009785  0.004093 -0.002334  0.003001  0.008184  0.003056  0.006566  0.001814 -0.001585  0.001882 -0.004458 -0.002103  0.002991 -0.007345  0.002959 -0.008530  0.007646  0.004977 -0.000146  0.006343 -0.000541 -0.005755  0.001152  0.008992 -0.001771  0.000350  0.006480 -0.001388  0.000940  0.000049  0.002851 -0.005394 -0.001650 -0.006473  0.000338 -0.005514 -0.005572 -0.009028  0.000752 -0.007764 -0.012244 -0.005157 -0.006716  0.005330  0.003827  0.001485 -0.003678 -0.004457  0.001550 -0.001947  0.002600 -0.001540  0.000218  0.000007 -0.007753 -0.003817 -0.006045  0.000046  0.002676  0.006600 -0.002802 -0.004759  0.006402  0.000959 -0.003725  0.004661  0.000370 -0.003612
ke         0.005543  0.001323 -0.005423  0.000701  0.002735  0.004202 -0.000997 -0.003678  0.002138  0.002746  0.002185 -0.002075 -0.006427  0.003627  0.008797  0.010645 -0.009044  0.002571 -0.005921  0.011680  0.004035  0.005233 -0.001273  0.001425 -0.007925  0.007782 -0.004559 -0.002626 -0.002266  0.006709 -0.006341 -0.001627  0.006002  0.001118 -0.006180 -0.002271  0.009454  0.004287  0.004271 -0.001617 -0.008382  0.003407  0.003706 -0.005499 -0.004181 -0.002460 -0.005441 -0.002382 -0.002473 -0.003546  0.009811 -0.006223  0.003545  0.005064 -0.001414  0.006766  0.011161 -0.005418 -0.006646 -0.005619 -0.008007 -0.001678 -0.002971 -0.006561  0.003833  0.002121  0.005310 -0.001525 -0.003865 -0.001392  0.000136  0.004754 -0.003809  0.002889 -0.006274  0.004797 -0.001784  0.005545 -0.007454  0.003299 -0.000750 -0.000559 -0.002048 -0.004121 -0.003942 -0.003328  0.003940 -0.002548  0.000866  0.007778 -0.003742 -0.002025 -0.006358 -0.008955  0.010437 -0.003629 -0.006482  0.002054  0.005044 -0.006208 -0.003033 -0.003511  0.000250 -0.003269 -0.002039  0.002825  0.005601  0.006777 -0.006405 -0.006718  0.008410 -0.000435 -0.003564  0.000756  0.006323 -0.000075 -0.006976  0.002005  0.006251  0.005829  0.002227 -0.007337 -0.001476  0.000815  0.001414 -0.008188 -0.007984  0.000828
--------------------------------------------------

&gt;&gt;&gt; Bagian 2: Analisis Sentimen (Fallback Kamus, tanpa PyTorch)
---
Judul 1: &#39;Jadwal Persib Bandung Hari Ini: Berjuang Bangkit Vs Persebaya&#39;
    Label: POSITIVE -&gt; Skor: 1.0000
------------------------------
Judul 2: &#39;Persib Bandung Pinjamkan Dimas Drajad ke Malut United&#39;
    Label: NEUTRAL -&gt; Skor: 0.0000
------------------------------
Judul 3: &#39;Prediksi Persib Bandung vs Persebaya pada Pekan Kelima Super League&#39;
    Label: NEUTRAL -&gt; Skor: 0.0000
------------------------------
Judul 4: &#39;Persija Jakarta Tunjuk Bambang Pamungkas sebagai Direktur Olahraga&#39;
    Label: NEUTRAL -&gt; Skor: 0.0000
------------------------------
Judul 5: &#39;Hasil Super League: Persita Raih Kemenangan Perdana, Kalahkan PSM Makassar secara Dramatis&#39;
    Label: POSITIVE -&gt; Skor: 0.8000
------------------------------
Judul 6: &#39;Permalukan Semen Padang di Kandangnya, Pelatih PSBS Biak Ungkap Kuncinya&#39;
    Label: POSITIVE -&gt; Skor: 1.0000
------------------------------
Judul 7: &#39;Jurnalis dan Konten Kreator Dibatasi dalam Merekam Pertandingan Sepak Bola&#39;
    Label: NEGATIVE -&gt; Skor: 1.0000
------------------------------
Judul 8: &#39;Bambang Pamungkas Jadi Direktur Olahraga Persija Jakarta, Apa Tugasnya?&#39;
    Label: NEUTRAL -&gt; Skor: 0.0000
------------------------------
Judul 9: &#39;Analisis Rahmad Darmawan Soal Kans Timnas Indonesia Lolos Piala Dunia 2026&#39;
    Label: POSITIVE -&gt; Skor: 1.0000
------------------------------
Judul 10: &#39;Hasil Super League: Semen Padang FC vs PSBS Biak, Skor Akhir 1-2&#39;
    Label: NEUTRAL -&gt; Skor: 0.0000
------------------------------

&gt;&gt;&gt; Bagian 3: Deteksi Entitas Bernama (Menggunakan spaCy)
---
Teks: Jadwal Persib Bandung Hari Ini: Berjuang Bangkit Vs Persebaya...

Entitas yang Terdeteksi:
    - Jadwal Persib Bandung Hari Ini (PERSON)
</pre></div>
</div>
</div>
</div>
</section>
<section id="klasifikasi">
<h2>Klasifikasi<a class="headerlink" href="#klasifikasi" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.feature_extraction.text</span><span class="w"> </span><span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">classification_report</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.preprocessing.text</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tokenizer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.preprocessing.sequence</span><span class="w"> </span><span class="kn">import</span> <span class="n">pad_sequences</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Embedding</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">,</span> <span class="n">Dense</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="c1"># --- Fungsi Pembersihan Teks</span>
<span class="k">def</span><span class="w"> </span><span class="nf">clean_text</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^\w\s]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">text</span>

<span class="c1"># --- Memuat Data dari File CSV</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;berita_tempo.csv&#39;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Berhasil memuat seluruh data dari file CSV: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Periksa apakah kolom &#39;judul&#39; ada</span>
    <span class="k">if</span> <span class="s1">&#39;judul&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Kolom &#39;judul&#39; tidak ditemukan dalam file CSV.&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

    <span class="c1"># Periksa apakah kolom &#39;kategori&#39; ada</span>
    <span class="k">if</span> <span class="s1">&#39;kategori&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Kolom &#39;kategori&#39; tidak ditemukan.&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

    <span class="c1"># --- Filter data valid ---</span>
    <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;judul&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;kategori&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">valid_labels</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="n">counts</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;kategori&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">valid_labels</span><span class="p">)]</span>

    <span class="n">corpus</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;judul&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># Label kategori -&gt; integer</span>
    <span class="n">label_to_id</span> <span class="o">=</span> <span class="p">{</span><span class="n">label</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;kategori&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())}</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">label_to_id</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;kategori&#39;</span><span class="p">]]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Kolom &#39;kategori&#39; ditemukan. Menggunakan label dari file.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Menggunakan label: </span><span class="si">{</span><span class="n">label_to_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: File &#39;</span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&#39; tidak ditemukan.&quot;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

<span class="c1"># --- Bersihkan teks</span>
<span class="n">cleaned_corpus</span> <span class="o">=</span> <span class="p">[</span><span class="n">clean_text</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">corpus</span><span class="p">]</span>

<span class="c1"># Split data</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">cleaned_corpus</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">labels</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Jumlah total data: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah data latih: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah data uji: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ======================================================</span>
<span class="c1"># 1. KLASIFIKASI MENGGUNAKAN TF-IDF</span>
<span class="c1"># ======================================================</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;&gt; KLASIFIKASI MENGGUNAKAN TF-IDF&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>

<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">max_features</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">X_train_tfidf</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_tfidf</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Contoh representasi</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- REPRESENTASI DATA DAN KONTEKS TF-IDF ---&quot;</span><span class="p">)</span>
<span class="n">contoh_tfidf</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="n">X_train</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">fitur_tfidf</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>
<span class="n">df_contoh_tfidf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">contoh_tfidf</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">todense</span><span class="p">(),</span> <span class="n">index</span><span class="o">=</span><span class="n">fitur_tfidf</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Skor TF-IDF&#39;</span><span class="p">])</span>
<span class="n">df_contoh_tfidf</span> <span class="o">=</span> <span class="n">df_contoh_tfidf</span><span class="p">[</span><span class="n">df_contoh_tfidf</span><span class="p">[</span><span class="s1">&#39;Skor TF-IDF&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Skor TF-IDF&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_contoh_tfidf</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">to_string</span><span class="p">())</span>

<span class="c1"># Logistic Regression</span>
<span class="n">model_tfidf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">class_weight</span><span class="o">=</span><span class="s1">&#39;balanced&#39;</span><span class="p">)</span>
<span class="n">model_tfidf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_tfidf</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred_tfidf</span> <span class="o">=</span> <span class="n">model_tfidf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_tfidf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Akurasi TF-IDF: </span><span class="si">{</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred_tfidf</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Laporan Klasifikasi TF-IDF:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_tfidf</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># ======================================================</span>
<span class="c1"># 2. KLASIFIKASI MENGGUNAKAN WORD EMBEDDING (Keras)</span>
<span class="c1"># ======================================================</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;&gt; KLASIFIKASI MENGGUNAKAN WORD EMBEDDING&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># Tokenisasi dan padding</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="p">(</span><span class="n">num_words</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">tokenizer</span><span class="o">.</span><span class="n">fit_on_texts</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">vocab_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">word_index</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">max_len</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">cleaned_corpus</span><span class="p">)</span>

<span class="n">X_train_seq</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">texts_to_sequences</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_seq</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">texts_to_sequences</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">X_train_padded</span> <span class="o">=</span> <span class="n">pad_sequences</span><span class="p">(</span><span class="n">X_train_seq</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=</span><span class="n">max_len</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">)</span>
<span class="n">X_test_padded</span> <span class="o">=</span> <span class="n">pad_sequences</span><span class="p">(</span><span class="n">X_test_seq</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=</span><span class="n">max_len</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">)</span>

<span class="n">embedding_dim</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Build model</span>
<span class="n">model_emb</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model_emb</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Embedding</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">output_dim</span><span class="o">=</span><span class="n">embedding_dim</span><span class="p">,</span> <span class="n">input_length</span><span class="o">=</span><span class="n">max_len</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;embedding_layer&quot;</span><span class="p">))</span>
<span class="n">model_emb</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Flatten</span><span class="p">())</span>
<span class="n">model_emb</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
<span class="n">model_emb</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">labels</span><span class="p">)),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">))</span>

<span class="n">model_emb</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span>
                  <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;sparse_categorical_crossentropy&#39;</span><span class="p">,</span>
                  <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>

<span class="n">model_emb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_padded</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Ambil vektor embedding</span>
<span class="n">embedding_layer</span> <span class="o">=</span> <span class="n">model_emb</span><span class="o">.</span><span class="n">get_layer</span><span class="p">(</span><span class="s1">&#39;embedding_layer&#39;</span><span class="p">)</span>
<span class="n">embedding_weights</span> <span class="o">=</span> <span class="n">embedding_layer</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">word_index</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">word_index</span>
<span class="n">word_to_vec</span> <span class="o">=</span> <span class="p">{</span><span class="n">word</span><span class="p">:</span> <span class="n">embedding_weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">word_index</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

<span class="k">if</span> <span class="s1">&#39;liverpool&#39;</span> <span class="ow">in</span> <span class="n">word_to_vec</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vektor untuk &#39;liverpool&#39;:</span><span class="se">\n</span><span class="si">{</span><span class="n">word_to_vec</span><span class="p">[</span><span class="s1">&#39;liverpool&#39;</span><span class="p">][:</span><span class="mi">10</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Kata &#39;liverpool&#39; tidak ditemukan di korpus.&quot;</span><span class="p">)</span>

<span class="c1"># Evaluasi</span>
<span class="n">loss</span><span class="p">,</span> <span class="n">accuracy</span> <span class="o">=</span> <span class="n">model_emb</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test_padded</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Akurasi Word Embedding: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">y_pred_probs_emb</span> <span class="o">=</span> <span class="n">model_emb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_padded</span><span class="p">)</span>
<span class="n">y_pred_emb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_pred_probs_emb</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Laporan Klasifikasi Word Embedding:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_emb</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Berhasil memuat seluruh data dari file CSV: berita_tempo.csv
Kolom &#39;kategori&#39; ditemukan. Menggunakan label dari file.
Menggunakan label: {&#39;bola&#39;: 0, &#39;metro&#39;: 1, &#39;dunia&#39;: 2}

Jumlah total data: 149
Jumlah data latih: 119
Jumlah data uji: 30

==================================================
&gt;&gt;&gt; KLASIFIKASI MENGGUNAKAN TF-IDF
==================================================

--- REPRESENTASI DATA DAN KONTEKS TF-IDF ---
           Skor TF-IDF
ketua         0.373209
perempuan     0.373209
sementara     0.373209
ma            0.343505
ajukan        0.322429
eks           0.281432
gen           0.281432
pm            0.281432
jadi          0.271650
nepal         0.220870

Akurasi TF-IDF: 0.87
Laporan Klasifikasi TF-IDF:
              precision    recall  f1-score   support

           0       0.82      0.90      0.86        10
           1       1.00      0.90      0.95        10
           2       0.80      0.80      0.80        10

    accuracy                           0.87        30
   macro avg       0.87      0.87      0.87        30
weighted avg       0.87      0.87      0.87        30


==================================================
&gt;&gt;&gt; KLASIFIKASI MENGGUNAKAN WORD EMBEDDING
==================================================
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\Raihan Fadillah\AppData\Local\Programs\Python\Python311\Lib\site-packages\keras\src\layers\core\embedding.py:97: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/10
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">1s</span> 15ms/step - accuracy: 0.3613 - loss: 1.0948
Epoch 2/10
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - accuracy: 0.8992 - loss: 1.0070
Epoch 3/10
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 10ms/step - accuracy: 1.0000 - loss: 0.9073
Epoch 4/10
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - accuracy: 1.0000 - loss: 0.7764
Epoch 5/10
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - accuracy: 1.0000 - loss: 0.6094
Epoch 6/10
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - accuracy: 1.0000 - loss: 0.4250
Epoch 7/10
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - accuracy: 1.0000 - loss: 0.2576
Epoch 8/10
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - accuracy: 1.0000 - loss: 0.1365
Epoch 9/10
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - accuracy: 1.0000 - loss: 0.0668
Epoch 10/10
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - accuracy: 1.0000 - loss: 0.0325
Kata &#39;liverpool&#39; tidak ditemukan di korpus.

Akurasi Word Embedding: 0.70
<span class=" -Color -Color-Bold">1/1</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 103ms/step
Laporan Klasifikasi Word Embedding:
              precision    recall  f1-score   support

           0       1.00      0.80      0.89        10
           1       0.71      0.50      0.59        10
           2       0.53      0.80      0.64        10

    accuracy                           0.70        30
   macro avg       0.75      0.70      0.71        30
weighted avg       0.75      0.70      0.71        30
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Tugas4_PPW.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">CRAWLING PTA MANAJEMEN</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tf-idf-vectorizer">TF - IDF Vectorizer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#word-embeding">Word Embeding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#klasifikasi">Klasifikasi</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Vania Putri
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>